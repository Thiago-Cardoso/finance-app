# 8.0 - Gerenciamento de TransaÃ§Ãµes

**Sprint:** Sprint 2 (Semanas 5-6)
**Prioridade:** P0
**Estimativa:** 5 dias
**ParalelizÃ¡vel:** Parcialmente

---

## ğŸ“‹ DescriÃ§Ã£o

Implementa funcionalidade completa de transaÃ§Ãµes: criaÃ§Ã£o, ediÃ§Ã£o, exclusÃ£o e listagem. Inclui formulÃ¡rio com validaÃ§Ã£o, FAB para criaÃ§Ã£o rÃ¡pida, lista paginada e integraÃ§Ã£o com API Rails. Ã‰ a funcionalidade mais usada do app (meta: < 30s para registrar transaÃ§Ã£o).

O formulÃ¡rio deve ter validaÃ§Ã£o inline, seleÃ§Ã£o fÃ¡cil de categoria/conta/data, e feedback visual apÃ³s salvar. A lista deve ter paginaÃ§Ã£o, filtros bÃ¡sicos e pull-to-refresh.

---

## ğŸ¯ Objetivos

- [ ] Criar formulÃ¡rio de transaÃ§Ã£o completo
- [ ] Implementar lista paginada de transaÃ§Ãµes
- [ ] Adicionar FAB para criaÃ§Ã£o rÃ¡pida
- [ ] Integrar com API de transaÃ§Ãµes
- [ ] Permitir ediÃ§Ã£o e exclusÃ£o
- [ ] Validar com Zod e React Hook Form

---

## ğŸ“ Subtarefas

### 8.1 - Service de TransaÃ§Ãµes
**Estimativa:** M
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/shared/services/api/transactions.service.ts`

**CÃ³digo:**
```typescript
export async function getTransactions(params?: TransactionFilters) {
  const response = await apiClient.get('/api/v1/transactions', { params });
  return response.data;
}

export async function createTransaction(data: CreateTransactionDTO) {
  const response = await apiClient.post('/api/v1/transactions', {
    transaction: data
  });
  return response.data.data;
}

export async function updateTransaction(id: number, data: Partial<CreateTransactionDTO>) {
  const response = await apiClient.patch(`/api/v1/transactions/${id}`, {
    transaction: data
  });
  return response.data.data;
}

export async function deleteTransaction(id: number) {
  await apiClient.delete(`/api/v1/transactions/${id}`);
}
```

**Checklist:**
- [ ] CRUD completo
- [ ] PaginaÃ§Ã£o
- [ ] Filtros
- [ ] Testes unitÃ¡rios

### 8.2 - Modelo e Schema de TransaÃ§Ã£o
**Estimativa:** S
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/shared/models/Transaction.model.ts`
- `src/shared/schemas/transaction.schema.ts`

**CÃ³digo:**
```typescript
export const transactionSchema = z.object({
  description: z.string().min(1, 'DescriÃ§Ã£o obrigatÃ³ria'),
  amount: z.string().min(1, 'Valor obrigatÃ³rio'),
  transaction_type: z.enum(['income', 'expense', 'transfer']),
  date: z.string(),
  category_id: z.number().optional(),
  account_id: z.number().optional(),
  notes: z.string().optional(),
});
```

**Checklist:**
- [ ] Interface Transaction criada
- [ ] Schema Zod criado
- [ ] ValidaÃ§Ãµes customizadas
- [ ] DTOs de criaÃ§Ã£o

### 8.3 - ViewModel de TransaÃ§Ãµes
**Estimativa:** L
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/viewModels/useTransaction.viewModel.ts`

**Checklist:**
- [ ] Load transactions com paginaÃ§Ã£o
- [ ] Create transaction
- [ ] Update transaction
- [ ] Delete transaction
- [ ] Loading states
- [ ] Error handling
- [ ] Testes unitÃ¡rios

### 8.4 - Zustand Transactions Store
**Estimativa:** M
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/shared/stores/transactionsStore.ts`

**Checklist:**
- [ ] Store com array de transactions
- [ ] AÃ§Ãµes CRUD
- [ ] Cache com TTL (5 min)
- [ ] InvalidaÃ§Ã£o de cache

### 8.5 - FormulÃ¡rio de TransaÃ§Ã£o
**Estimativa:** XL
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/app/transactions/TransactionForm.view.tsx`
- `src/app/transactions/components/CategorySelector.tsx`
- `src/app/transactions/components/AccountSelector.tsx`
- `src/app/transactions/components/DatePicker.tsx`

**Comandos:**
```bash
npm install react-hook-form @hookform/resolvers
```

**Checklist:**
- [ ] FormulÃ¡rio com React Hook Form
- [ ] ValidaÃ§Ã£o com Zod
- [ ] MoneyInput para valor
- [ ] Seletor de tipo (receita/despesa)
- [ ] Seletor de categoria (com Ã­cones)
- [ ] Seletor de conta
- [ ] DatePicker
- [ ] Campo de observaÃ§Ãµes opcional
- [ ] BotÃ£o salvar com loading

### 8.6 - Lista de TransaÃ§Ãµes
**Estimativa:** L
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/app/transactions/TransactionList.view.tsx`
- `src/app/transactions/components/TransactionItem.tsx`

**Checklist:**
- [ ] FlatList com paginaÃ§Ã£o
- [ ] TransactionItem com Ã­cone, descriÃ§Ã£o, valor
- [ ] Swipe actions (editar, deletar)
- [ ] Pull-to-refresh
- [ ] Infinite scroll
- [ ] Empty state
- [ ] Skeleton loaders

### 8.7 - Tela de Detalhe
**Estimativa:** M
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/app/transactions/TransactionDetail.view.tsx`

**Checklist:**
- [ ] Exibir todos os campos
- [ ] BotÃµes editar/deletar
- [ ] Modal de confirmaÃ§Ã£o de exclusÃ£o

### 8.8 - FAB (Floating Action Button)
**Estimativa:** S
**Tipo:** Desenvolvimento

**Checklist:**
- [ ] FAB fixo na tela
- [ ] Navega para TransactionForm
- [ ] AnimaÃ§Ã£o de entrada/saÃ­da

### 8.9 - Filtros BÃ¡sicos
**Estimativa:** M
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/app/transactions/components/FilterBar.tsx`

**Checklist:**
- [ ] Filtro por tipo (receita/despesa)
- [ ] Filtro por perÃ­odo (mÃªs atual, Ãºltimo mÃªs)
- [ ] Aplicar filtros na API

### 8.10 - Testes
**Estimativa:** L
**Tipo:** Teste

**Checklist:**
- [ ] Testes do ViewModel
- [ ] Testes do formulÃ¡rio
- [ ] Testes da lista
- [ ] Testes de integraÃ§Ã£o
- [ ] Cobertura > 80%

---

## ğŸ”— DependÃªncias

**Bloqueia:** 12.0, 13.0, 14.0, 16.0, 18.0, 19.0, 20.0
**Bloqueado por:** 7.0, 9.0, 10.0
**Paralelo com:** Nenhuma (depende de contas e categorias)

---

## âœ… CritÃ©rios de Sucesso

- [ ] TransaÃ§Ã£o criada em < 30 segundos
- [ ] FormulÃ¡rio com validaÃ§Ã£o inline
- [ ] Lista paginada funcionando
- [ ] EdiÃ§Ã£o e exclusÃ£o funcionais
- [ ] FAB acessÃ­vel em todas as telas
- [ ] Pull-to-refresh e infinite scroll
- [ ] Cobertura de testes: 80%
- [ ] Code review aprovado

---

## ğŸ“š ReferÃªncias

- [PRD - RF03](../prd.md#rf03---registro-de-transaÃ§Ãµes)
- [PRD - Fluxo 2](../prd.md#fluxo-2-registro-de-transaÃ§Ã£o)
- [Tech Spec - 3.2.3](../tech-spec.md#323-transaÃ§Ãµes)
- [React Hook Form](https://react-hook-form.com/)

---

## ğŸ·ï¸ Tags

`#transactions` `#forms` `#crud` `#critical`

---

## ğŸ“Œ Notas Importantes

- FormulÃ¡rio deve salvar no backend imediatamente (nÃ£o usar SQLite local)
- ValidaÃ§Ã£o tanto no cliente quanto no servidor
- Usar optimistic updates (feedback instantÃ¢neo)
- Swipe actions: editar (azul), deletar (vermelho)
- ConfirmaÃ§Ã£o obrigatÃ³ria antes de deletar
- FormataÃ§Ã£o de valor monetÃ¡rio: R$ 1.234,56
- Data padrÃ£o: hoje
- Cache de transaÃ§Ãµes: 5 minutos

---

**Criado em:** 2025-11-10
**Atualizado em:** 2025-11-10
**Status:** â³ NÃ£o iniciada
