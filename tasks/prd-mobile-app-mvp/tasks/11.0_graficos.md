# 11.0 - Componentes de Gr√°ficos

**Sprint:** Sprint 2 (Semana 6)
**Prioridade:** P0
**Estimativa:** 4 dias
**Paraleliz√°vel:** Sim (ap√≥s 2.0)

---

## üìã Descri√ß√£o

Implementa componentes de gr√°ficos reutiliz√°veis usando Victory Native: gr√°fico de pizza (despesas por categoria), gr√°fico de linha (evolu√ß√£o de saldo), gr√°fico de barras (receitas vs despesas). Componentes devem ser responsivos, interativos e seguir o design system.

Gr√°ficos s√£o essenciais para visualiza√ß√£o de dados no Dashboard e Relat√≥rios. Devem renderizar r√°pido (< 1s) e suportar temas claro/escuro.

---

## üéØ Objetivos

- [ ] Criar PieChart (despesas por categoria)
- [ ] Criar LineChart (evolu√ß√£o de saldo)
- [ ] Criar BarChart (receitas vs despesas)
- [ ] Garantir responsividade
- [ ] Adicionar interatividade (tap para detalhes)
- [ ] Suportar temas claro/escuro

---

## üìù Subtarefas

### 11.1 - Setup do Victory Native
**Estimativa:** S
**Tipo:** Setup

**Comandos:**
```bash
npm install victory-native react-native-svg
```

**Checklist:**
- [ ] Victory Native instalado
- [ ] react-native-svg configurado
- [ ] Teste b√°sico de gr√°fico

### 11.2 - Componente PieChart
**Estimativa:** L
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/shared/components/charts/PieChart.tsx`

**C√≥digo:**
```typescript
import { VictoryPie } from 'victory-native';

interface PieChartProps {
  data: Array<{
    label: string;
    value: number;
    color: string;
  }>;
  width?: number;
  height?: number;
}

export function PieChart({ data, width = 300, height = 300 }: PieChartProps) {
  return (
    <VictoryPie
      data={data.map(item => ({ x: item.label, y: item.value }))}
      colorScale={data.map(item => item.color)}
      width={width}
      height={height}
      padding={50}
      innerRadius={60}
      labels={({ datum }) => `${datum.x}\n${datum.y}%`}
      style={{
        labels: { fontSize: 12, fill: '#000' }
      }}
    />
  );
}
```

**Checklist:**
- [ ] PieChart implementado
- [ ] Cores customiz√°veis
- [ ] Labels com percentual
- [ ] Donut chart (innerRadius)
- [ ] Responsivo
- [ ] Testes unit√°rios

### 11.3 - Componente LineChart
**Estimativa:** L
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/shared/components/charts/LineChart.tsx`

**C√≥digo:**
```typescript
import { VictoryLine, VictoryChart, VictoryAxis } from 'victory-native';

interface LineChartProps {
  data: Array<{ date: string; balance: number }>;
  width?: number;
  height?: number;
}

export function LineChart({ data, width = 350, height = 250 }: LineChartProps) {
  return (
    <VictoryChart width={width} height={height}>
      <VictoryAxis
        tickFormat={(t) => new Date(t).toLocaleDateString('pt-BR', { day: '2-digit', month: 'short' })}
        style={{ tickLabels: { fontSize: 10, angle: -45 } }}
      />
      <VictoryAxis dependentAxis />
      <VictoryLine
        data={data.map(item => ({ x: item.date, y: item.balance }))}
        style={{ data: { stroke: '#5843BE', strokeWidth: 2 } }}
      />
    </VictoryChart>
  );
}
```

**Checklist:**
- [ ] LineChart implementado
- [ ] Eixos formatados
- [ ] Cor prim√°ria do tema
- [ ] Tooltip ao tocar
- [ ] Responsivo
- [ ] Testes unit√°rios

### 11.4 - Componente BarChart
**Estimativa:** M
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/shared/components/charts/BarChart.tsx`

**Checklist:**
- [ ] BarChart com 2 s√©ries (receitas, despesas)
- [ ] Cores distintas
- [ ] Labels nos eixos
- [ ] Responsivo
- [ ] Testes unit√°rios

### 11.5 - Componente AreaChart (opcional)
**Estimativa:** M
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/shared/components/charts/AreaChart.tsx`

**Checklist:**
- [ ] AreaChart para tend√™ncias
- [ ] Gradiente
- [ ] Responsivo

### 11.6 - Helper de Formata√ß√£o
**Estimativa:** S
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/shared/utils/chartFormatters.ts`

**C√≥digo:**
```typescript
export function formatCurrency(value: number): string {
  return new Intl.NumberFormat('pt-BR', {
    style: 'currency',
    currency: 'BRL',
  }).format(value);
}

export function formatPercentage(value: number): string {
  return `${value.toFixed(1)}%`;
}

export function formatDate(date: string): string {
  return new Date(date).toLocaleDateString('pt-BR', {
    day: '2-digit',
    month: 'short',
  });
}
```

**Checklist:**
- [ ] formatCurrency
- [ ] formatPercentage
- [ ] formatDate
- [ ] Testes unit√°rios

### 11.7 - Tema para Gr√°ficos
**Estimativa:** S
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/config/chartTheme.ts`

**Checklist:**
- [ ] Tema claro
- [ ] Tema escuro
- [ ] Cores consistentes com design system

### 11.8 - Componente de Loading
**Estimativa:** S
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/shared/components/charts/ChartSkeleton.tsx`

**Checklist:**
- [ ] Skeleton loader para gr√°ficos
- [ ] Anima√ß√£o pulse
- [ ] Tamanhos variados

### 11.9 - Testes
**Estimativa:** M
**Tipo:** Teste

**Checklist:**
- [ ] Testes de cada tipo de gr√°fico
- [ ] Testes de formata√ß√£o
- [ ] Snapshots
- [ ] Cobertura > 80%

---

## üîó Depend√™ncias

**Bloqueia:** 7.0 (Dashboard usa gr√°ficos), 13.0 (Relat√≥rios usa gr√°ficos)
**Bloqueado por:** 2.0
**Paralelo com:** 8.0, 9.0, 10.0

---

## ‚úÖ Crit√©rios de Sucesso

- [ ] 3 tipos de gr√°ficos funcionais (Pie, Line, Bar)
- [ ] Renderiza√ß√£o < 1 segundo
- [ ] Responsivos em diferentes telas
- [ ] Suporte a temas claro/escuro
- [ ] Interatividade (tap para detalhes)
- [ ] Formata√ß√£o de valores consistente
- [ ] Cobertura de testes: 80%
- [ ] Code review aprovado

---

## üìö Refer√™ncias

- [PRD - RF02.3](../prd.md#rf02---dashboard-principal)
- [Victory Native Docs](https://commerce.nearform.com/open-source/victory-native/)
- [Victory Examples](https://formidable.com/open-source/victory/gallery/)

---

## üè∑Ô∏è Tags

`#charts` `#dataviz` `#victory-native` `#critical`

---

## üìå Notas Importantes

- Victory Native usa react-native-svg (j√° instalado)
- Testar em iOS e Android (renderiza√ß√£o pode variar)
- Evitar gr√°ficos muito complexos (performance)
- Limitar pontos de dados (max 50 pontos)
- Usar memo para evitar re-renders desnecess√°rios
- Labels devem ser leg√≠veis em telas pequenas
- Cores devem ter contraste adequado (WCAG AA)

---

**Criado em:** 2025-11-10
**Atualizado em:** 2025-11-10
**Status:** ‚è≥ N√£o iniciada
