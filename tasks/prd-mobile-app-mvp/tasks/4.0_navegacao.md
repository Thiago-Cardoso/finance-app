# 4.0 - Estrutura de Navega√ß√£o

**Sprint:** Sprint 1 (Semana 3)
**Prioridade:** P0
**Estimativa:** 2 dias
**Paraleliz√°vel:** N√£o

---

## üìã Descri√ß√£o

Implementa a estrutura completa de navega√ß√£o do aplicativo usando React Navigation 6.x, incluindo Stack Navigator para fluxos de autentica√ß√£o e Bottom Tabs Navigator para a navega√ß√£o principal autenticada. Define rotas, transi√ß√µes e deep linking.

A navega√ß√£o √© o esqueleto do app, conectando todas as telas e garantindo fluxos intuitivos entre autentica√ß√£o, dashboard, transa√ß√µes e outras features.

---

## üéØ Objetivos

- [x] Configurar React Navigation
- [x] Criar Stack Navigator para auth
- [x] Criar Bottom Tabs para app principal
- [x] Implementar navega√ß√£o condicional (autenticado/n√£o-autenticado)
- [x] Configurar deep linking
- [x] Definir tipos TypeScript para rotas

---

## üìù Subtarefas

### 4.1 - Configura√ß√£o Inicial
**Estimativa:** S
**Tipo:** Setup

**Arquivos:**
- `src/routes/index.tsx`
- `src/routes/types.ts`

**Comandos:**
```bash
npm install @react-navigation/native @react-navigation/stack @react-navigation/bottom-tabs
npm install react-native-screens react-native-safe-area-context react-native-gesture-handler
```

**Checklist:**
- [x] React Navigation instalado
- [x] NavigationContainer configurado
- [x] Tipos TypeScript criados

### 4.2 - Auth Stack Navigator
**Estimativa:** M
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/routes/auth.routes.tsx`

**C√≥digo:**
```typescript
import { createStackNavigator } from '@react-navigation/stack';
import Login from '@/app/auth/Login.view';
import Register from '@/app/auth/Register.view';
import ForgotPassword from '@/app/auth/ForgotPassword.view';

const Stack = createStackNavigator();

export function AuthRoutes() {
  return (
    <Stack.Navigator screenOptions={{ headerShown: false }}>
      <Stack.Screen name="Login" component={Login} />
      <Stack.Screen name="Register" component={Register} />
      <Stack.Screen name="ForgotPassword" component={ForgotPassword} />
    </Stack.Navigator>
  );
}
```

**Checklist:**
- [x] Stack Navigator criado
- [x] Telas de auth integradas
- [x] Transi√ß√µes configuradas
- [x] Header oculto

### 4.3 - App Bottom Tabs Navigator
**Estimativa:** L
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/routes/app.routes.tsx`

**C√≥digo:**
```typescript
import { createBottomTabNavigator } from '@react-navigation/bottom-tabs';
import { Home, TrendingUp, PieChart, User } from 'lucide-react-native';
import Dashboard from '@/app/dashboard/Dashboard.view';
import TransactionList from '@/app/transactions/TransactionList.view';
import Reports from '@/app/reports/Reports.view';
import Profile from '@/app/profile/Profile.view';

const Tab = createBottomTabNavigator();

export function AppRoutes() {
  return (
    <Tab.Navigator
      screenOptions={{
        tabBarActiveTintColor: '#5843BE',
        tabBarInactiveTintColor: '#9CA3AF',
        headerShown: false,
      }}
    >
      <Tab.Screen
        name="Dashboard"
        component={Dashboard}
        options={{
          tabBarIcon: ({ color }) => <Home color={color} size={24} />,
          tabBarLabel: 'In√≠cio',
        }}
      />
      <Tab.Screen
        name="Transactions"
        component={TransactionList}
        options={{
          tabBarIcon: ({ color }) => <TrendingUp color={color} size={24} />,
          tabBarLabel: 'Transa√ß√µes',
        }}
      />
      <Tab.Screen
        name="Reports"
        component={Reports}
        options={{
          tabBarIcon: ({ color }) => <PieChart color={color} size={24} />,
          tabBarLabel: 'Relat√≥rios',
        }}
      />
      <Tab.Screen
        name="Profile"
        component={Profile}
        options={{
          tabBarIcon: ({ color }) => <User color={color} size={24} />,
          tabBarLabel: 'Perfil',
        }}
      />
    </Tab.Navigator>
  );
}
```

**Checklist:**
- [x] Bottom Tabs criado
- [x] 4 tabs principais (Dashboard, Transa√ß√µes, Relat√≥rios, Perfil)
- [x] √çcones Lucide configurados
- [x] Cores do tema aplicadas

### 4.4 - Root Navigator (Condicional)
**Estimativa:** M
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/routes/index.tsx`

**C√≥digo:**
```typescript
import { NavigationContainer } from '@react-navigation/native';
import { useAuthStore } from '@/shared/stores/authStore';
import { AuthRoutes } from './auth.routes';
import { AppRoutes } from './app.routes';

export function Routes() {
  const { isAuthenticated } = useAuthStore();

  return (
    <NavigationContainer>
      {isAuthenticated ? <AppRoutes /> : <AuthRoutes />}
    </NavigationContainer>
  );
}
```

**Checklist:**
- [x] Navega√ß√£o condicional implementada
- [x] Troca autom√°tica ap√≥s login
- [x] Splash screen durante verifica√ß√£o

### 4.5 - Tipos TypeScript para Navega√ß√£o
**Estimativa:** S
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/routes/types.ts`

**C√≥digo:**
```typescript
import { NavigatorScreenParams } from '@react-navigation/native';

export type AuthStackParamList = {
  Login: undefined;
  Register: undefined;
  ForgotPassword: undefined;
};

export type AppTabsParamList = {
  Dashboard: undefined;
  Transactions: undefined;
  Reports: undefined;
  Profile: undefined;
};

export type RootStackParamList = {
  Auth: NavigatorScreenParams<AuthStackParamList>;
  App: NavigatorScreenParams<AppTabsParamList>;
  TransactionForm: { transactionId?: number };
  AccountForm: { accountId?: number };
};
```

**Checklist:**
- [x] Tipos de rotas definidos
- [x] Tipos de par√¢metros definidos
- [x] TypeScript sem erros

### 4.6 - Deep Linking
**Estimativa:** M
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/routes/index.tsx`
- `app.json`

**Checklist:**
- [x] Linking config criado
- [x] Deep links para telas principais
- [x] app.json com scheme

### 4.7 - Navega√ß√£o Imperativa
**Estimativa:** S
**Tipo:** Desenvolvimento

**Arquivos:**
- `src/shared/utils/navigation.ts`

**Checklist:**
- [x] Helper para navega√ß√£o fora de componentes
- [x] Fun√ß√µes de navega√ß√£o reutiliz√°veis

### 4.8 - Testes de Navega√ß√£o
**Estimativa:** M
**Tipo:** Teste

**Checklist:**
- [ ] Testes de rotas condicionais
- [ ] Testes de deep linking
- [ ] Cobertura > 70%

---

## üîó Depend√™ncias

**Bloqueia:** 5.0, 7.0, 8.0, todas as telas
**Bloqueado por:** 3.0
**Paralelo com:** Nenhuma

---

## ‚úÖ Crit√©rios de Sucesso

- [x] Navega√ß√£o entre telas funcionando
- [x] Bottom tabs vis√≠veis e responsivos
- [x] Troca autom√°tica auth/app ap√≥s login
- [x] Deep linking funcional
- [x] Tipos TypeScript corretos
- [x] Anima√ß√µes suaves
- [ ] Cobertura de testes: 70%
- [ ] Code review aprovado

---

## üìö Refer√™ncias

- [PRD - Se√ß√£o 4.1](../prd.md#41-stack-mobile)
- [React Navigation Docs](https://reactnavigation.org/)
- [Bottom Tabs Guide](https://reactnavigation.org/docs/bottom-tab-navigator/)

---

## üè∑Ô∏è Tags

`#navigation` `#routing` `#react-navigation` `#critical`

---

## üìå Notas Importantes

- Usar headerShown: false e criar headers customizados
- Bottom tabs devem ter feedback visual (active/inactive)
- Testar transi√ß√µes em iOS e Android
- Deep links devem abrir telas corretas
- Suporte a gestures (swipe back no iOS)

---

**Criado em:** 2025-11-10
**Atualizado em:** 2025-11-17
**Status:** ‚úÖ Conclu√≠da (testes pendentes)
