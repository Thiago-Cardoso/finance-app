# 6.0 - Infraestrutura de Testes

**Sprint:** Sprint 0-1 (Semanas 1-2)
**Prioridade:** P0
**Estimativa:** 2 dias
**Paraleliz√°vel:** Sim (ap√≥s 1.0)

---

## üìã Descri√ß√£o

Configura infraestrutura completa de testes unit√°rios, integra√ß√£o e E2E. Inclui Jest, React Native Testing Library, mocks de API e helpers de teste. Estabelece padr√µes e conven√ß√µes de testes para todo o projeto.

Meta: atingir 70%+ de cobertura geral, com foco em ViewModels e services cr√≠ticos. Testes devem rodar r√°pido no CI e localmente.

---

## üéØ Objetivos

- [x] Configurar Jest e Testing Library
- [x] Criar mocks de API e stores
- [x] Estabelecer conven√ß√µes de testes
- [x] Configurar coverage reports
- [x] Criar helpers de teste reutiliz√°veis
- [x] Integrar testes no CI/CD

---

## üìù Subtarefas

### 6.1 - Configura√ß√£o do Jest
**Estimativa:** M
**Tipo:** Setup

**Arquivos:**
- `jest.config.js`
- `jest.setup.js`

**Comandos:**
```bash
npm install --save-dev jest @testing-library/react-native @testing-library/jest-native
npm install --save-dev @types/jest
```

**Checklist:**
- [x] Jest configurado
- [x] Suporte a TypeScript
- [x] Coverage configurado
- [x] Scripts npm criados

### 6.2 - Mocks de API
**Estimativa:** M
**Tipo:** Desenvolvimento

**Arquivos:**
- `__mocks__/axios.ts`
- `__tests__/helpers/mockApi.ts`

**Checklist:**
- [x] Mock do axios
- [x] Respostas fake da API
- [x] Helpers de mock

### 6.3 - Mocks de Stores (Zustand)
**Estimativa:** S
**Tipo:** Desenvolvimento

**Arquivos:**
- `__tests__/helpers/mockStores.ts`

**Checklist:**
- [x] Mock do authStore
- [x] Mock de outros stores
- [x] Reset entre testes

### 6.4 - Helpers de Teste
**Estimativa:** M
**Tipo:** Desenvolvimento

**Arquivos:**
- `__tests__/helpers/renderWithProviders.tsx`
- `__tests__/helpers/testUtils.ts`

**C√≥digo:**
```typescript
// renderWithProviders.tsx
import { render } from '@testing-library/react-native';
import { NavigationContainer } from '@react-navigation/native';

export function renderWithProviders(component: React.ReactElement) {
  return render(
    <NavigationContainer>
      {component}
    </NavigationContainer>
  );
}
```

**Checklist:**
- [x] renderWithProviders criado
- [x] Wrapper com Navigation
- [x] Wrapper com stores mockados

### 6.5 - Testes de Exemplo
**Estimativa:** S
**Tipo:** Desenvolvimento

**Arquivos:**
- `__tests__/unit/components/Button.test.tsx`
- `__tests__/unit/viewModels/useAuth.viewModel.test.ts`

**Checklist:**
- [x] Teste de componente UI
- [x] Teste de ViewModel
- [x] Teste de service
- [x] Documenta√ß√£o de padr√µes

### 6.6 - Coverage Reports
**Estimativa:** S
**Tipo:** Setup

**Arquivos:**
- `.github/workflows/ci.yml`
- `jest.config.js`

**Checklist:**
- [x] Coverage no CI
- [x] Threshold m√≠nimo configurado
- [x] Reports em HTML

### 6.7 - Documenta√ß√£o de Testes
**Estimativa:** S
**Tipo:** Documenta√ß√£o

**Arquivos:**
- `docs/TESTING.md`

**Checklist:**
- [x] Guia de como escrever testes
- [x] Conven√ß√µes de nomenclatura
- [x] Exemplos de boas pr√°ticas

---

## üîó Depend√™ncias

**Bloqueia:** Todas as tarefas (testes s√£o cont√≠nuos)
**Bloqueado por:** 1.0
**Paralelo com:** 2.0, 3.0

---

## ‚úÖ Crit√©rios de Sucesso

- [x] Jest rodando localmente e no CI
- [x] Mocks de API funcionando
- [x] Coverage reports gerados
- [x] Testes de exemplo passando
- [x] Documenta√ß√£o completa
- [x] CI falhando se coverage < 70%
- [ ] Code review aprovado

---

## üìö Refer√™ncias

- [PRD - Se√ß√£o 7.1](../prd.md#71-estrat√©gia-de-testes)
- [Testing Library Docs](https://testing-library.com/docs/react-native-testing-library/intro/)
- [Jest Docs](https://jestjs.io/)

---

## üè∑Ô∏è Tags

`#testing` `#infrastructure` `#jest` `#quality` `#critical`

---

## üìå Notas Importantes

- Testes devem rodar em < 30s
- Coverage m√≠nimo: 70%
- ViewModels e services s√£o prioridade
- Usar data-testid para queries
- Evitar testes de implementa√ß√£o (testar comportamento)

---

**Criado em:** 2025-11-10
**Atualizado em:** 2025-11-17
**Status:** ‚úÖ Conclu√≠da
